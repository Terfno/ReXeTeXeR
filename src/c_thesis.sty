%% This is file `c_thesis.sty',

% TeXファイルに以下の２行を追加してください
% \kanjiskip=.25zw plus 3pt minus 3pt
% \xkanjiskip=.25zw plus 3pt minus 3pt

% スタイルファイルの読み込み
\usepackage{mathptmx}
\usepackage{fancybox}
\usepackage[dvipdfmx]{graphicx} % EPS しか取り込まない場合オプションはdvips。JPEG とか PNG を使うなら dvipdfm
% \usepackage{url} % \url（URL）を参考文献のなかで使うのに必要
% \usepackage{amsmath}% 数式関連
\usepackage{txfonts} %
\usepackage{caption} % 図のキャプション関係
% \usepackage[small,normal,bf,up]{caption} % 図のキャプション関係

% 今日の日にちの再定義
\renewcommand{\today}{令和\number\reiwa 年 \number\month 月 \number\day 日}

% ページレイアウトの定義
\setlength{\voffset}{-1truein}
\addtolength{\voffset}{25truemm}
\setlength{\topmargin}{0truemm}
\setlength{\headheight}{0truemm}
\setlength{\headsep}{0truemm}
\setlength{\hoffset}{-1truein}
\addtolength{\hoffset}{25truemm}
\setlength{\oddsidemargin}{0.5truecm} % 追加した場所
\setlength{\evensidemargin}{0.5truecm}
\setlength{\textheight}{247truemm}
\setlength{\textwidth}{155truemm}
\setlength{\footskip}{10truemm}
% \addtolength{\textheight}{\topskip}
\renewcommand{\baselinestretch}{1.1}

% thebibrography環境の見出しの再定義
\renewcommand{\bibname}{参考文献}

% 参考文献のラベルに番号を用いる。無駄な項目の入力なくなる。利用方法(\bib{参考文献1,参考文献2})
\newcounter{bibnum}\setcounter{bibnum}{0}
\def\bib#1{\begin{thebibliography}{99}\@for\memoryc:=#1
\do{\addtocounter{bibnum}{1}\bibitem{\thebibnum}\memoryc}\end{thebibliography}}

% 引用記号の再定義
\def\@biblabel#1{#1)}

% 参考文献の引用は体裁のとおり上つき文字で表示
\DeclareRobustCommand\cite{\unskip\@ifnextchar[{\@tempswatrue\@citex}{\@tempswafalse\@citex[]}}
\def\@cite#1#2{$^{\hbox{\scriptsize{#1\if@tempswa,#2\fi})}}$}

% \@maketitleで使用するポイントの設定
\newcommand{\DAIMEI}{\@setfontsize\DAIMEI{21}{31.5}}
\newcommand{\NAMAE}{\@setfontsize\NAMAE{16}{32}} % 25.5
\newcommand{\KUHAKU}{\@setfontsize\KUHAKU{28}{42}}

% \bossと\syozoku命令の追加
\def\adviser#1{\gdef\@adviser{#1}}
\gdef\@adviser{} % 変更点
\def\affiliation#1{\gdef\@affiliation{#1}}
\gdef\@affiliation{} % 変更点
\def\kind#1{\gdef\@kind{#1}}
\gdef\@kind{} % 変更点

% ハイフネーションを禁止
\hyphenpenalty=20000\relax
\exhyphenpenalty=20000\relax
\sloppy

% 参考文献の表示形式変更（この場合 参考文献（番号）の表示 デフォルトでは上つき文字になる）
% \def\@cite#1#2{({#1\if@tempswa , #2\fi})}

% \postsectionnameの定義
\renewcommand{\postsectionname}{.}

\newcommand{\@sidou}{指導教員}
\newcommand{\@school}{津山工業高等専門学校}
\newcommand{\@gakka}{総合理工学科}
\newcommand{\interim}{卒業研究中間報告書}
% \newcommand{\interim}{情報工学実験Ｖ報告書}
\newcommand{\preliminary}{卒業研究予備審査論文}
\newcommand{\thesis}{卒業研究報告書}

% \@maketitleの定義-
\renewcommand{\@maketitle}{
  \setlength{\voffset}{-1.0truein}
  \addtolength{\voffset}{40truemm}
  \setlength{\topmargin}{0truemm}
  \setlength{\headheight}{0truemm}
  \setlength{\headsep}{0truemm}
  \setlength{\hoffset}{0truept}
  \setlength{\oddsidemargin}{0.46truecm} % 追加した場所
  \setlength{\evensidemargin}{0.46truecm}
  \setlength{\textheight}{247truemm}
  \setlength{\textwidth}{155truemm}
  \setlength{\footskip}{0truemm}
  \begin{center}
    {\Huge \@kind  \par}
  \end{center}
  \begin{center}
    \let\footnote\thanks
    \vspace{2.3truecm}
    {\DAIMEI \@title \par}
  \end{center}
  \vspace{2.3truecm}
  \begin{center}
    {\NAMAE \@sidou \par}
    {\NAMAE \@adviser \par}
    \vspace{1.4truecm}
  \end{center}
  \begin{center}
    {\NAMAE \@school \par}
    {\NAMAE \@gakka \par}
    {\NAMAE \@affiliation \par}
    \vspace{1.4truecm}
  \end{center}
  \begin{center}
    {\NAMAE  \@author\par}
    \vspace{1.4truecm}
    {\NAMAE \@date\par}
  \end{center}
  \thispagestyle{empty}
  \newpage
  \ifvoid\@abstractbox\else\centerline{\box\@abstractbox}\vskip1.5em\fi
}

% 図、表のフォントサイズの変更
\captionsetup[figure]{labelsep=quad, font=normalsize}
\captionsetup[table]{labelsep=quad, font=normalsize}

% 図、表、数式を参照するときに例として\figurenum{ラベル名で}カウンタの番号の前に「図」が表示される。
\def\figurenum#1{\figurename\ref{#1}}
\def\tablenum#1{\tablename\ref{#1}}
\def\equnum#1{\equationname(\ref{#1})}
\renewcommand{\labelenumi}{\theenumi）}
\def\slabel#1{\ref{#1}\sname}
\def\hurokuf#1{\figurename\ref{#1}}
\def\hurokut#1{\tablename\ref{#1}}

% 目次などの表題を変えるときに使うよ。
% 自分で表示変えたいときは以下を変更してね。(% をはずしてね{}のなかの文字を変えてください。)
% \renewcommand{\postpartname}{部}
% \renewcommand{\contentsname}{目次}
% \renewcommand{\listfigurename}{図目次}
% \renewcommand{\listtablename}{表目次}
% \renewcommand{\refname}{参考文献}
% \renewcommand{\indexname}{索引}
% \renewcommand{\figurename}{図}
% \renewcommand{\tablename}{表}
% \renewcommand{\appendixname}{付録}
\renewcommand{\abstractname}{Abstract}
\newcommand{\abstractnamae}{概要}
\newcommand{\sname}{節}

% グラフ表示時の簡略化
% \def\graph#1#2#3#4#5{
% \begin{figure}[#1]
% \centering
% \includegraphics[#2]{#3}
% \caption{#4}
% \label{#5}
% \end{figure}
% }

% 文字除去
% \def\coma{,}
% \def\comas#1{\@tfor\memory:=#1\do{\ifx\coma\memory\relax\else\memory\fi}}

% 情報工学実験Vのときは「概要」、卒業研究報告書では「Abstract」表示にするためのもの(考えたができなかった)
% \newcounter{@N}
%  \setcounter{@N}{0}
%  \def\moji{V}
%  % \def\dispeigo#1{\@tfor\memorye:=#1\do{\ifx\moji\memorye\addtocounter{@N}{1}\else\relax\fi}}
%  \newcommand{\comparator}{\ifnum\the@N<1 \abstractname\else\abstractnamae\fi}
%  \def\mojicount#1{
%   \@tfor\memoryd:=#1\do{\addtocounter{@N}{1}\the@N}
% }
% \def\comparator{\ifnum\the@N>9 \abstractnamae\else\abstractname\fi}

% equation環境で、数式の番号を節を含んだ番号にする。 例：(1.1)}
% \renewcommand{\theequation}{
% \arabic{section}.\arabic{equation} }
% \@addtoreset{equation}{section}

% thebibliography環境の再定義（参考文献を目次に出すだけ）
\renewenvironment{thebibliography}[1]{
  \addcontentsline{toc}{section}{\refname}
  \global\let\presectionname\relax
  \global\let\postsectionname\relax
  \section*{\refname}\@mkboth{\refname}{\refname}
  \list{\@biblabel{\@arabic\c@enumiv}}{
    \settowidth\labelwidth{\@biblabel{#1}}
    \leftmargin\labelwidth
    \advance\leftmargin\labelsep
    \@openbib@code
    \usecounter{enumiv}
    \let\p@enumiv\@empty
    \renewcommand\theenumiv{\@arabic\c@enumiv}
  }
  \sloppy
  \clubpenalty4000
  \@clubpenalty\clubpenalty
  \widowpenalty4000
  \sfcode`\.\@m
}
{
  \def\@noitemerr{\@latex@warning{Empty `thebibliography' environment}}
	\endlist
}

% \appendix命令の再定義(付録になると改ページし、ページのカウンタをゼロにする。ページ番号の変更(A--○○)
\renewcommand{\appendix}{
  \par
  \newpage
  \setcounter{section}{0}
  \setcounter{figure}{0}
  \setcounter{table}{0}
  \def\thepage{A--\arabic{page}}
  \setcounter{subsection}{0}
  \setcounter{page}{1}
  \gdef\presectionname{\appendixname}
  \renewcommand{\refname}{付録参考文献}
  \renewcommand{\figurename}{付図}
  \renewcommand{\tablename}{付表}
  \gdef\postsectionname{}
  \gdef\thesection{\presectionname\@Alph\c@section\postsectionname}
  \gdef\thesubsection{\@Alph\c@section.\@arabic\c@subsection}
}

% 目次のsection命令とページ番号の間の破線表示(http://oku.edu.mie-u.ac.jp/tex/mod/forum/discuss.php?d=233)より引用
% subsectionについても追記
\def\@pnumwidth{3.0em}

\renewcommand*{\l@section}[2]{
  \ifnum \c@tocdepth >\z@
  \addpenalty{\@secpenalty}
  \addvspace{1.0em \@plus\p@}
  \begingroup
  \parindent\z@
  \rightskip\@tocrmarg
  \parfillskip-\rightskip
  \leavevmode\headfont
  \setlength\@lnumwidth{4zw}
  \advance\leftskip\@lnumwidth \hskip-\leftskip
  #1\nobreak\leaders\hbox{\normalfont$\m@th \mkern \@dotsep mu\hbox{.}\mkern \@dotsep mu$}\hfill\nobreak\hbox to\@pnumwidth{\hss#2}\par
  \endgroup
  \fi
}

\renewcommand*{\l@subsection}{
  \@tempdima\jsc@tocl@width \advance\@tempdima -1zw
  \@dottedtocline{2}{\@tempdima}{3zw}
}

% 図を囲んで中央ぞろえ（使い方）\begin{figure}[htbp]\begin{figbox}\includegraphics[]{}\end{figbox}\end{figure}
\newenvironment{figbox}
{\begin{center}\begin{Sbox}}
{\end{Sbox}\end{center}\fbox{\TheSbox}}

% listingを読み込んだ時に利用（付録等で)
\newenvironment{Cprogram}
{\begin{lstlisting}[framerule=.4pt,frame=shadowbox,language=C]}
{\end{lstlisting}}

% section関連の再定義
\renewcommand{\section}{
  \@startsection{section}{1}{1zw}
  {0.7\Cvs}{0.7\Cvs}
  {\normalsize\bf\raggedright}
}

\renewcommand{\subsection}{
  \@startsection{subsection}{1}{1zw}
  {.5\Cvs \@plus.5\Cdp \@minus.2 \Cdp}
  {.2\Cvs \@plus.3\Cdp}
  {\normalsize\bf\raggedright}
}

\renewcommand{\subsubsection}{
  \@startsection{subsubsection}{1}{1zw}
  {.5\Cvs \@plus.5\Cdp \@minus.2 \Cdp}
  {.2\Cvs \@plus.3\Cdp}
  {\normalsize\bf\raggedright}
}

% 図の囲み
\newenvironment{bverbatim}[1]
{
  \VerbatimEnvironment
  \centering
  \begin{Sbox}
  \begin{minipage}{#1}
  \begin{Verbatim}
}
{
  \end{Verbatim}
  \end{minipage}
  \end{Sbox}
  \begin{center}
  \fbox{\TheSbox}
  \end{center}
}
%% ここまでマクロ定義

% abstract環境はページ番号なしで(\null\vfil)上側のスペースを削除して上側余白を調整
\renewenvironment{abstract}{
  \titlepage
  \@beginparpenalty\@lowpenalty
  \begin{center}
    \headfont \abstractname
    \@endparpenalty\@M
  \end{center}
  \par
}
{
  \par\vfil\null\endtitlepage
}

% 英語タイトルとあわせて表示する場合には以下を利用\fcaption{日本語}{英語} 表も同様//今後このような形式になる場合もあり？
% \def\fcaption#1#2{
% \addtocounter{figure}{1}%  図番号進める
% \def\@currentlabel{\arabic{figure}} %  図番号の表示方法（図番号)) あくまで例
% \centering
% 図\@currentlabel #1 \par
% Fig.\@currentlabel #2
% }
% \def\tcaption#1#2{
% \addtocounter{table}{1}%  図のカウンタを一つ進める
% \def\@currentlabel{\arabic{table}} %  図番号の表示方法（図番号)) あくまで例
% \centering
% 表\@currentlabel #1 \par
% Table.\@currentlabel #2
% }

% tableofcontentsの再定義
% 幅の定義について引用して記述
% jsarticle.clsを参照 https://github.com/texjporg/jsclasses/blob/832c665cfc3a144f1a298e5b7d238efbd3b8942f/jsarticle.cls

\newdimen\jsc@tocl@width % dimen定義

\renewcommand{\tableofcontents}{
  \settowidth\jsc@tocl@width{\headfont\presectionname\postsectionname}
  \settowidth\@tempdima{\headfont\appendixname}
  \ifdim\jsc@tocl@width<\@tempdima\relax\setlength\jsc@tocl@width{\@tempdima}\fi
  \ifdim\jsc@tocl@width<2zw \divide\jsc@tocl@width by 2 \advance\jsc@tocl@width 1zw\fi

  \section*{\contentsname}
  \@mkboth{\contentsname}{\contentsname}
  \@starttoc{toc}
  \thispagestyle{empty}
  \newpage
  \setcounter{page}{1}
}

%  enumerate 環境の再定義
\renewcommand{\labelenumi}{(\arabic{enumi})}
\renewcommand{\labelenumii}{(\alph{enumii})}
\renewcommand{\labelenumiii}{(\roman{enumiii})}

% This is the end of file `eeses.sty'.
